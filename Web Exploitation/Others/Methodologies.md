# Recon

## Summary
- [Enumerate directories](#enumerate-directories)
- [Enumerate subdomains](#enumerate-subdomains)
- [Parameters fuzzing](#parameters-enumeration)
- [Files & files extension fuzzing](#files--files-extension-fuzzing)
- [Vulnerability scan](#vulnerability-scan)
- [Credentials enumeration](#credentials-enumeration)
  - [Bruteforce username](#bruteforce-username)
  - [Bruteforce password](#bruteforce-password)
  - [Bruteforce both username & password](#bruteforce-both-username--password)
  - [Basic auth bruteforce](#basic-auth-bruteforce)
- [Fuzz POST data](#fuzz-post-data)
  - [Fuzz for parameter value](#fuzz-for-parameter-value)
  - [Fuzz for MFA code](#fuzz-for-mfa-code)
- [Dencode & cracking](#dencode--cracking)
  - [Crack /etc/shadow hash](#crack-etc-shadow-hash)
  - [Crack SSH key](#crack-ssh-key)
  - [Crack a hash string](#crack-a-hash-string)
  - [Decode base64](#decode-base64)
  - [Crack Zip file](#crack-zip-file)
  - [Crack PGP key](#crack-pgp-key)
  - [Identify a hash mode](#identify-a-hash-mode)
  - [Generate wordlist with Cewl](#generate-wordlist-with-cewl)
  - [Generate SSH key](#generate-ssh-key)
  - [Create a hash string](#create-a-hash-string)
  
## Enumerate directories
- `gobuster dir -u [url] -w [wordlists] -t 10 -x txt,php,sh,cgi,html,zip,bak,sql,old,ppm -b 400,404 -U [user] -P [password] -r`

- `gobuster dir -u http://10.10.211.97/ -w /usr/share/wordlists/dirb/common.txt -s "204,301,302,307,401,403" --timeout 20s`

- `dirb [url]`

- `feroxbuster -u http://example.com/ -d 0 -r -C 403,404 -w /wordlists/common.txt -t 40`

- `feroxbuster -u http://example.com/ -C 403,404 -w /wordlists/common.txt -t 40`

- `ffuf -u http://[ip]/FUZZ -c -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories-lowercase.txt -e .txt,.php -fc 403`

## Enumerate subdomains
- `wfuzz -c --hw 977 -u [url] -H "Host: FUZZ.[domain]" -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt`

- `wfuzz -c -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -u "[url]" -H "Host: FUZZ.[hostname]" --hw 290`

- `ffuf -u http://vulnnet.thm -H "Host: FUZZ.vulnnet.thm" -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -fs 5829`

- `ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -u http://FUZZ.wekor.thm -of -o result`

- `ffuf -w [wordlists] -H "Host:FUZZ.domain" -u [url]`

- `amass enum --passive -d example.com`

- `dnsrecon -n 10.10.142.241 -d undiscovered.thm -D /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -t brt`

- `wfuzz -c -f dns.txt -w wordlist.txt -u 'http://example.com' -H 'Host:FUZZ.example.com' --hw 290 --hc 404,302`

- `gobuster vhost -u http://example.com/ -w wordlists.txt | grep 200`

- `gobuster dns -d example.com -w wordlist.txt`

## Parameters fuzzing
- `wfuzz -c -z file,/usr/share/wordlists/wfuzz/general/medium.txt --hc 400 -X POST -u [url]\?FUZZ\=test`

- `ffuf -u http://vulnnet.thm/?FUZZ=/etc/passwd -w /usr/share/wordlists/SecLists/Discovery/Web-Content/burp-parameter-names.txt -fs 5829`

- `wfuzz -w /usr/share/wordlists/dirb/common.txt --hc=404 "http://10.10.244.142:5000/api/v1/resources/books?FUZZ=/etc/passwd"`

- `ffuf -u "http://example.com?FUZZ=id" -w /usr/share/wordlists/SecLists/Discovery/Web-Content/burp-parameter-names.txt -fw 1`

## Files & files extension fuzzing
- `wfuzz -w /data/src/wordlists/directory-list-2.3-medium.txt --hc 404 -u [url/FUZZ.[filename]]`

- `wfuzz -w /data/src/wordlists/directory-list-2.3-medium.txt --hc 404 -c --hh 3834 -t 1 http://example.com/FUZZ.bak.txt`

- `ffuf -u http://example.com/FUZZ.pdf -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt`

- `wfuzz -c -w /usr/share/wordlists/SecLists/Fuzzing/LFI/LFI-gracefulsecurity-linux.txt -u [url/example.php?example=FUZZ] --hw=0`

## Vulnerability scan
```
nikto -h [domain or ip]
nikto -h [domain or ip] -ssl
nikto -h [ip or domain] -Format msf+
```

## Credentials enumeration
### Bruteforce username
- `ffuf -w rockyou.txt -X POST -d "username=FUZZ&password=password123" -H "Content-Type: application/x-www-form-urlencoded" -u http://example.com/login -mr "Username not found"`

- `hydra -L username.txt -p password123 10.0.0.1 http-post-form “/login.php:name=^USER^&pwd=password123:Username not found”`

### Bruteforce password
- `ffuf -w rockyou.txt -X POST -d "username=admin&password=FUZZ" -H "Content-Type: application/x-www-form-urlencoded" -u http://example.com/login -mr "Invalid password."`

- `hydra -l admin -P password.txt 10.0.0.1 http-post-form “/login.php:name=admin&pwd=^PASS^:Invalid password:H=cookie.session”`

### Bruteforce both username & password
- `ffuf -w username.txt:W1,password.txt:W2 -X POST -d "username=W1&password=W2" -u http://example.com/login -fc 200`

- `hydra -C userpass.txt http-get://example.com/login`

### Basic auth bruteforce
```
hydra -l [username] -P [password wordlists] [ip] -s [port] http-get [url]
hydra -l username -P wordlist -e ns IP http-get /admin/
hydra -l username -P wordlist -e ns -f IP http-get /admin/index.php
```

## Fuzz POST data
### Fuzz for parameter value
- `wfuzz -c -z file,numbers.txt -H "X-Originating-IP: 127.0.0.1" -d "number=FUZZ" --hw 81 http://10.10.60.231:8085/`

### Fuzz for MFA code
- `hydra -l [username] -P [wordlists] 127.0.0.1 http-post-form "/console/mfa.php:code=^PASS^:F=Incorrect code:H=Cookie: PHPSESSID=gckm1it42pqrbk2hikjk1oseos; user=jason_test_account; pwd=violet"`

## Dencode & cracking
### Crack /etc/shadow/hash
1. `copy /etc/shadow and /etc/passwd in 2 different files`

2. `unshadow passwd shadow > unshadowed.txt`

3. `john --wordlist=/usr/share/wordlists/rockyou.txt --format=sha512crypt unshadowed.txt`

### Crack SSH key
1. `ssh2john id_rsa > hash.txt`

2. `john --wordlist=rockyou.txt hash.txt`

### Crack a hash string
- `john --wordlist=rockyou.txt hash.txt`

- `hashcat -a 0 -m 0 {hash string} /usr/share/wordlists/rockyou.txt --force`

### Decode base64
- `echo -n "[text]" | base64 -d`

### Crack Zip file
1. `zip2john file.zip > output.txt`

2. `john --wordlist=rockyou.txt output.txt`

### Crack PGP key
1. `gpg2john private_key > output.txt`

2. `john --wordlist=/usr/share/wordlists/rockyou.txt output.txt`

### Identify a hash mode
- `hashid -m '{hash string}'`

- `hash-identifier '{hash string}`

### Generate wordlist with Cewl
```
cewl http://example.com/simeon -d 5 -m 5 -w pass.txt
cewl http://example.com/simeon > pass.txt
```

### Generate SSH key
- `ssh-keygen -f id_rsa`

### Create a hash string
- `openssl passwd -1 -salt username password`

- `python3 -c 'import crypt;crypt.crypt("hello")'`
